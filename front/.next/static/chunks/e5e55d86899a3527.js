(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55436,e=>{"use strict";let s=(0,e.i(75254).default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);e.s(["Search",()=>s],55436)},33245,e=>{"use strict";var s=e.i(43476);e.i(47167);var t=e.i(71645),r=e.i(55436),a=e.i(75254);let i=(0,a.default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var l=e.i(37727),n=e.i(31278),d=e.i(52900),o=e.i(21531),c=e.i(46696);function m(){let[e,a]=(0,t.useState)(""),[m,x]=(0,t.useState)(!1),[h,g]=(0,t.useState)([]),[u,y]=(0,t.useState)(!1),[f,b]=(0,t.useState)(null),[p,j]=(0,t.useState)(new Set),{friends:v,sendFriendRequest:w,friendRequests:N}=(0,d.useFriendsStore)(),{cliente:k}=(0,o.useClienteStore)();(0,t.useEffect)(()=>{(async()=>{y(!0),b(null);try{let e=await fetch("http://localhost:3001/clientes");if(!e.ok)throw Error("Erro ao carregar usuários");let s=await e.json(),t=[];if(Array.isArray(s))t=s;else if(s.clientes&&Array.isArray(s.clientes))t=s.clientes;else if(s.data&&Array.isArray(s.data))t=s.data;else throw Error("Formato de resposta inválido");g(t)}catch(e){b(e instanceof Error?e.message:"Erro ao carregar usuários")}finally{y(!1)}})()},[]);let S=Array.isArray(h)?h.filter(s=>s.id!==k.id&&!v.some(e=>e.id===s.id)&&(s.nome.toLowerCase().includes(e.toLowerCase())||s.email.toLowerCase().includes(e.toLowerCase()))):[],C=e=>N.some(s=>s.receiverId===e&&"pending"===s.status)||p.has(e),A=async e=>{j(s=>new Set([...s,e.id]));try{await w(e.id,e.nome,e.email),a(""),c.toast.success(`Pedido de amizade enviado para ${e.nome}!`,{style:{background:"#00c950",color:"#ffffff"}})}catch(s){j(s=>{let t=new Set(s);return t.delete(e.id),t}),c.toast.error("Erro ao enviar pedido de amizade.")}};return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(r.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Procurar usuários...",value:e,onChange:e=>{a(e.target.value),x(!0)},onFocus:()=>x(!0),className:"w-full pl-10 pr-10 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:u}),u&&(0,s.jsx)(n.Loader2,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 animate-spin"}),e&&!u&&(0,s.jsx)("button",{onClick:()=>{a(""),x(!1)},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:(0,s.jsx)(l.X,{className:"w-5 h-5"})})]}),f&&(0,s.jsx)("div",{className:"absolute z-50 w-full mt-2 bg-red-50 rounded-lg shadow-lg border border-red-200 p-4 text-center text-red-600",children:f}),m&&e&&!u&&!f&&S.length>0&&(0,s.jsx)("div",{className:"absolute z-50 w-full mt-2 bg-white rounded-lg shadow-lg border border-gray-200 max-h-80 overflow-y-auto",children:S.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center text-green-600 font-semibold",children:e.nome.charAt(0).toUpperCase()}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-gray-900",children:e.nome}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]})]}),(0,s.jsx)("button",{onClick:()=>A(e),disabled:C(e.id)||p.has(e.id),className:`p-2 rounded-lg text-white transition-colors ${C(e.id)||p.has(e.id)?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,title:C(e.id)?"Pedido de amizade enviado":"Enviar pedido de amizade",children:(0,s.jsx)(i,{className:"w-5 h-5"})})]},e.id))}),m&&e&&!u&&!f&&0===S.length&&(0,s.jsx)("div",{className:"absolute z-50 w-full mt-2 bg-white rounded-lg shadow-lg border border-gray-200 p-4 text-center text-gray-500",children:"Nenhum usuário encontrado"})]})}var x=e.i(94983);let h=(0,a.default)("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var g=e.i(61911),u=e.i(18566);let y=(0,a.default)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);var f=e.i(17595);function b(){let{friendRequests:e,acceptFriendRequest:r,rejectFriendRequest:a}=(0,d.useFriendsStore)(),{cliente:l}=(0,o.useClienteStore)(),[n,c]=(0,t.useState)([]),[m,x]=(0,t.useState)(!0);(0,t.useEffect)(()=>{l?.id&&h()},[l?.id]);let h=async()=>{try{x(!1);let e=f.default.get("token"),s=await fetch(`http://localhost:3001/friendRequests/${l?.id}`,{headers:{Authorization:`Bearer ${e}`}});if(s.ok){let e=await s.json();c(e)}}catch(e){x(!1)}},g=async e=>{try{await r(e.id,{id:e.solicitante.id,nome:e.solicitante.nome,email:e.solicitante.email}),c(n.filter(s=>s.id!==e.id))}catch(e){}},u=async e=>{try{await a(e.id),c(n.filter(s=>s.id!==e.id))}catch(e){}};return m||0===n.length?null:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-8",children:[(0,s.jsx)("div",{className:"p-4 border-b border-gray-200 bg-green-50",children:(0,s.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[(0,s.jsx)(i,{className:"w-5 h-5 text-green-600"}),"Solicitações de Amizade (",n.length,")"]})}),(0,s.jsx)("div",{className:"divide-y divide-gray-100",children:n.map(e=>(0,s.jsxs)("div",{className:"p-4 hover:bg-gray-50 transition-colors flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center text-green-600 font-semibold text-lg",children:e.solicitante.nome.charAt(0).toUpperCase()}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-gray-900",children:e.solicitante.nome}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:e.solicitante.email}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:new Date(e.createdAt).toLocaleDateString("pt-BR")})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>g(e),className:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 transition-colors font-medium text-sm",children:"Aceitar"}),(0,s.jsxs)("button",{onClick:()=>u(e),className:"px-4 py-2 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors font-medium text-sm flex items-center gap-2",children:[(0,s.jsx)(y,{className:"w-4 h-4"}),"Rejeitar"]})]})]},e.id))})]})}function p(){let{friends:e,removeFriend:r,messages:a,openChat:i,loadFriends:l}=(0,d.useFriendsStore)(),{cliente:n,isHydrated:c}=(0,o.useClienteStore)(),y=(0,u.useRouter)();return((0,t.useEffect)(()=>{!c||n&&n.id||y.push("/login")},[n,y,c]),(0,t.useEffect)(()=>{c&&n?.id&&l()},[c,n?.id,l]),c&&n&&n.id)?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-4 sm:py-8",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 max-w-6xl",children:[(0,s.jsxs)("div",{className:"mb-6 sm:mb-8",children:[(0,s.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2 flex items-center gap-2 sm:gap-3",children:[(0,s.jsx)(g.Users,{className:"w-6 h-6 sm:w-8 sm:h-8 text-green-600"}),"Meus Amigos"]}),(0,s.jsx)("p",{className:"text-sm sm:text-base text-gray-600",children:"Conecte-se e converse com seus amigos"})]}),(0,s.jsx)("div",{className:"mb-6 sm:mb-8",children:(0,s.jsx)(m,{})}),(0,s.jsx)(b,{}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,s.jsx)("div",{className:"p-3 sm:p-4 border-b border-gray-200",children:(0,s.jsxs)("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:["Lista de Amigos (",e.length,")"]})}),0===e.length?(0,s.jsxs)("div",{className:"p-8 sm:p-12 text-center",children:[(0,s.jsx)(g.Users,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-300 mx-auto mb-3 sm:mb-4"}),(0,s.jsx)("p",{className:"text-gray-500 text-base sm:text-lg mb-2",children:"Você ainda não tem amigos"}),(0,s.jsx)("p",{className:"text-sm sm:text-base text-gray-400",children:"Use a busca acima para encontrar e adicionar amigos"})]}):(0,s.jsx)("div",{className:"divide-y divide-gray-100",children:e.map(e=>{let t,l=(t=e.id,a.filter(e=>e.senderId===t&&e.receiverId===n.id&&!e.read).length);return(0,s.jsxs)("div",{className:"p-3 sm:p-4 hover:bg-gray-50 transition-colors flex items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4 min-w-0 flex-1",children:[(0,s.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-green-100 flex items-center justify-center text-green-600 font-semibold text-base sm:text-lg flex-shrink-0",children:e.nome.charAt(0).toUpperCase()}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("p",{className:"font-semibold text-gray-900 text-sm sm:text-base truncate",children:e.nome}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-gray-500 truncate",children:e.email})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,s.jsxs)("button",{onClick:()=>i(e),className:"relative p-2 rounded-lg bg-green-600 text-white hover:bg-green-700 transition-colors",title:"Enviar mensagem",children:[(0,s.jsx)(x.MessageCircle,{className:"w-4 h-4 sm:w-5 sm:h-5"}),l>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 sm:w-5 sm:h-5 bg-red-500 text-white text-[10px] sm:text-xs rounded-full flex items-center justify-center",children:l})]}),(0,s.jsx)("button",{onClick:()=>{var s;return s=e.id,void(confirm("Tem certeza que deseja remover este amigo?")&&r(s))},className:"p-2 rounded-lg bg-red-100 text-red-600 hover:bg-red-200 transition-colors",title:"Remover amigo",children:(0,s.jsx)(h,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]},e.id)})})]})]})}):null}e.s(["default",()=>p],33245)}]);